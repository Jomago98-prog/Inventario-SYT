<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>InventarioSYT</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      background-color: #f8f8f8;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="text"], input[type="number"], input[type="file"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #218838;
    }
    label {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Formulario de Inventario</h1>
  <form id="formulario">
    <input type="text" id="nombre" placeholder="Nombre" required>
    <input type="text" id="codigoSAP" placeholder="Código SAP" required>
    <input type="text" id="reserva" placeholder="Reserva">
    <input type="text" id="disciplina" placeholder="Disciplina">
    <input type="text" id="descripcion" placeholder="Descripción">
    <input type="number" id="cantidad" placeholder="Cantidad">
    <input type="text" id="diametro" placeholder="Diámetro">
    <input type="text" id="sch" placeholder="Sch">
    <input type="text" id="longitud" placeholder="Longitud">
    <input type="text" id="peso" placeholder="Peso (Kg)">
    <input type="text" id="fabricante" placeholder="Fabricante">
    <input type="text" id="serial" placeholder="Serial">
    <input type="text" id="modelo" placeholder="Modelo">
    <input type="text" id="escala" placeholder="Escala">
    <input type="text" id="certificado" placeholder="Certificado">
    <input type="text" id="proveedor" placeholder="Proveedor">
    <input type="text" id="inspeccion" placeholder="Inspección">
    <input type="text" id="observaciones" placeholder="Observaciones">
    <label>Imágenes (máx 6):</label>
    <input type="file" id="imagenes" multiple accept="image/*">
    <button type="submit">Guardar</button>
  </form>

  <script>
    document.getElementById("formulario").addEventListener("submit", async function(e){
      e.preventDefault();

      const data = {
        marcaTemporal: new Date().toISOString(),
        nombre: document.getElementById("nombre").value,
        codigoSAP: document.getElementById("codigoSAP").value,
        reserva: document.getElementById("reserva").value,
        disciplina: document.getElementById("disciplina").value,
        descripcion: document.getElementById("descripcion").value,
        cantidad: document.getElementById("cantidad").value,
        diametro: document.getElementById("diametro").value,
        sch: document.getElementById("sch").value,
        longitud: document.getElementById("longitud").value,
        peso: document.getElementById("peso").value,
        fabricante: document.getElementById("fabricante").value,
        serial: document.getElementById("serial").value,
        modelo: document.getElementById("modelo").value,
        escala: document.getElementById("escala").value,
        certificado: document.getElementById("certificado").value,
        proveedor: document.getElementById("proveedor").value,
        inspeccion: document.getElementById("inspeccion").value,
        observaciones: document.getElementById("observaciones").value
      };

      const imagenFiles = document.getElementById("imagenes").files;
      const imagenesBase64 = [];
      for (let i = 0; i < imagenFiles.length && i < 6; i++) {
        const base64 = await fileToBase64(imagenFiles[i]);
        imagenesBase64.push(base64);
      }

      for (let i = 0; i < 6; i++) {
        data[`imagen${i+1}`] = imagenesBase64[i] || "";
      }

      try {
        const response = await fetch("https://sheetdb.io/api/v1/8ma5fhqubdk9o", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(data)
        });

        if (response.ok) {
          alert("✅ Producto guardado en Google Sheets");
        } else {
          alert("❌ Error al guardar en Google Sheets: " + response.statusText);
        }
      } catch (error) {
        alert("❌ Error de red o conexión: " + error);
      }
    });

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = (error) => reject(error);
      });
    }
  </script>
</body>
</html>
